{% extends 'adminpanel/base.html' %}

{% load static %}

{% block title %}Answer and Replies{% endblock %}

{% block page_heading %}

<div>
    Answers and Replies
    <div class="page-title-subheading">This is a dedicated Moderator dashboard for Collectanea Content writers.
    </div>
</div>

{% endblock %}


{% block dashboard %}

  <div class="row">
  	
  	<div class="col-md-12">
  		
  		<div class="main-card mb-3 card" style="position:relative; background-color: ;">
        <div class="card-body">
            <h5 class="card-title" 
                style="overflow: hidden;
                      text-overflow: ellipsis;
                      display: -webkit-box;
                      -webkit-line-clamp: 3;
                      -webkit-box-orient: vertical;
                      font-size: 20px;
                      text-transform: none;">
            {% if not question.status == 'deleted' %}
              {{question.content|title}} 
            {% else %}
              <i>Question Deleted</i>
            {% endif %} 
            
            <div style="float: right;">
            {% if question.status == 'deleted' %}
            <a href="{% url 'adminpanel:retrieve_question' question.id %}">
              <button class=" border-0 btn-transition btn btn-outline-info">
                <i class="fa fa-fw" aria-hidden="true" title="Restore content"></i>
              </button> 
            </a>
            {% else %}
              <button class=" border-0 btn-transition btn btn-outline-warning js-edit-question" data-toggle="modal" data-target="#modal-book"  data-url="{% url 'adminpanel:edit_question' question.id %}">
                <i class="fa fa-fw" aria-hidden="true" title="Edit"></i>
              </button>  
              <a href="{% url 'adminpanel:delete_question' question.id %}"> 
              <button class=" border-0 btn-transition btn btn-outline-danger">
                <i class="fa fa-fw" aria-hidden="true" title="Delete"></i>
              </button>  
              </a>
            {% endif %}
             
            </div>
              
            </h5>
            
          <p class="card-subtitle">
            <div class="mb-2 mr-2 badge badge-pill badge-success">{{question.category}}</div>

            {% for keyword in question.keywords_associated.all %}
            <div class="mb-2 mr-2 badge badge-pill badge-info">{{keyword}}</div>
                {% endfor %}                
          </p>

            <div class="widget-content p-0">
                <div class="widget-content-wrapper">
                  <div class="widget-content-left">
                    <div class="btn-group">
                      <a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="p-0 btn">
                        <img width="42" class="rounded-circle" src="/static/moderatorpanel/images/avatars/1.jpg" alt="">
                      </a>
                                
                    </div>
                  </div>
                  <div class="widget-content-left  ml-3 header-user-info">
                    <div class="widget-heading">
                      {{question.author}}

                    </div>
                    <div class="widget-subheading">
                      {{question.author.profession}}
                    </div>

                  </div>
                        
                </div>
                <div class="mt-3 ml-2" style="position: relative;">
                  <p style="">
                      Total Answers : {{question.answer_count}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    
                      <i class="fa fa-heart m-1" aria-hidden="true" title="Copy to use thumbs-up">&nbsp;</i>{{question.like_count}}
                    <i class="fa fa-fw m-1" aria-hidden="true" title="Copy to use arrow-up"></i> {{question.upvote_count}}
                    <i class="fa fa-fw m-1" aria-hidden="true" title="Copy to use arrow-down"></i> {{question.downvote_count}}
                  </p>
                </div>
            </div>  <p></p>
            {% for answer in ans_obj %}
          <div class="main-card mb-3 ml-5 card" style="background-color: #f2f2f2;">
            <div class="card-body">
              <a href="" style="text-decoration: none; color: black;">  
            	<img width="30" class="rounded-circle" src="/static/moderatorpanel/images/avatars/1.jpg" alt="">&nbsp;
              {{answer.user_id.fullname|title}}
              </a>
            <div style="float: right;">
            {% if answer.status == 'deleted' %}
            <a href="{% url 'adminpanel:retrieve_answer' answer.id %}">
              <button class=" border-0 btn-transition btn btn-outline-info">
                <i class="fa fa-fw" aria-hidden="true" title="Restore content"></i>
              </button> 
            </a>
            {% else %}
              <a href="{% url 'adminpanel:delete_answer' answer.id %}">
              <button class="border-0 btn-transition btn btn-outline-danger">
                <i class="fa fa-fw" aria-hidden="true" title="Copy to use trash"></i>
              </button>  
              </a>
            {% endif %}
            </div>
              <p class="ml-4">
                  {% if not answer.status == 'deleted' %}
                	 {{answer.content}}
                  {% else %}
                    <i>Answer Deleted</i>
                  {% endif %}
                
              </p> 
            </div>
            {% if not replies.count == 0 %}
            <div class="container">
            	<div id="exampleAccordion" data-children=".item">
            	<div class="item mb-3">
                <span>
                <button type="button" aria-expanded="false" aria-controls="exampleAccordion" data-toggle="collapse" data-target="#collapseExample{{forloop.counter}}" class="mb-1 mr-1 btn btn-outline-dark btn-sm">Click to see all {{replies.count}} Replies</button></span>
                <span style="float: right;">
                <i class="fa fa-fw m-1 " aria-hidden="true" title="Copy to use thumbs-up"></i>{{answer.like_count}}
                <i class="fa fa-fw m-1" aria-hidden="true" title="Copy to use thumbs-down"></i>{{answer.dislike_count}}
                </span>
                {% for reply in replies_obj %}

                  <div data-parent="#exampleAccordion" id="collapseExample{{forloop.parentloop.counter}}" class="collapse" style="">
                  	<p class="">
                  		<div class="main-card ml-5 card" style="background-color: #e2e2e2; ">
                  			<div class="card-body">
                  				<a href="" style="text-decoration: none; color: black;">  
					            	<img width="30" class="rounded-circle" src="/static/moderatorpanel/images/avatars/1.jpg" alt="">&nbsp;{{ reply.user_id.fullname|title }}
				              	</a>
                        <div style="float: right;">
                          {% if reply.status == 'deleted' %}
                          <a href="{% url 'adminpanel:retrieve_answer' answer.id %}">
                            <button class=" border-0 btn-transition btn btn-outline-info">
                              <i class="fa fa-fw" aria-hidden="true" title="Restore content"></i>
                            </button>
                          </a>
                          {% else %}
                          <a href="{% url 'adminpanel:delete_reply' reply.id %}">
                          <button class="border-0 btn-transition btn btn-outline-danger">
                            <i class="fa fa-fw" aria-hidden="true" title="Copy to use trash"></i>
                          </button>  
                          </a>
                          {% endif %}
                        </div>
                        <p class="ml-4">
                  				{% if not reply.status == 'deleted' %}
                           {{reply}}
                          {% else %}
                            <i>Reply Deleted</i>
                          {% endif %}
                        </p>
                        <div style="float: right;">
                          <i class="fa fa-fw m-1 " aria-hidden="true" title="Copy to use thumbs-up"></i>{{reply.like_count}}
                          <i class="fa fa-fw m-1" aria-hidden="true" title="Copy to use thumbs-down"></i>{{reply.dislike_count}}
                        </div>
                  			</div>
                  		</div>
                  	</p>

                  {% if replies_obj.has_other_pages and forloop.last and replies_obj.has_next %}
                  <a href="?page={{ replies_obj.next_page_number }}">
                  <button class="mb-2 mr-2 border-0 btn-transition btn btn-outline-dark">See More Replies</button>
                  </a>
                  {% endif %}

                  </div>

                {% endfor %}
                                    

              </div>
            </div>
            </div>
            {% endif %}
    	    </div>
            {% empty %}
             <center> Oops No Answer! </center>
            {% endfor %}
            
        </div>
  </div>

  	</div>

  </div>	

{% endblock %}